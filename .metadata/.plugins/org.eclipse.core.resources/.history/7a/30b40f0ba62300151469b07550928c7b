import java.io.*;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date; 
import java.util.Scanner;

import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.ss.usermodel.*;

public class BuildExcel 
{
	public static void main(String[] args) throws IOException
	{
		System.out.println("Which folder in the desktop would you like to use? (PNG, CAL, SOCA, etc.)");
		Scanner in = new Scanner(System.in);
		
		String prefix = in.nextLine();
		//CREATE WORKBOOK
		Workbook wb = new HSSFWorkbook();
	    FileOutputStream fileOut = new FileOutputStream("/Users/James/Desktop/" + prefix + ".xls");
	    
	    //NEW SHEET
	    Sheet sheet1 = wb.createSheet("sheet1");
	    
	    //OPEN FOLDER AND GET LIST OF FILES
	    String directory = "/Users/James/Desktop/" + prefix;
	    File folder = new File(directory);
	    
		// gets you the list of files at this folder
		File[] listOfFiles = folder.listFiles();
		
		//CONVERT FILE NAMES TO STRINGS
		String[] fileNames;
		fileNames = new String[listOfFiles.length];
		for (int i = 0; i < listOfFiles.length; ++i)
		{
			fileNames[i] = listOfFiles[i].toString().substring(directory.length());
		}
		
		
		//CYCLE THROUGH
		for(int i=1; i < fileNames.length; i++)
		{
		    //NEW ROW
		    Row row = sheet1.createRow(i);
		    
		    //SKU
		    String SKU = fileNames[i].substring(1, prefix.length()+4);
		    row.createCell(0).setCellValue(SKU);
		    		
		    //POST TITLE
		    String postTitleJPG = fileNames[i].substring(SKU.length()+1).replace("-", " ").replace("_", " "); //remove unused characters
		    String postTitle = postTitleJPG.substring(0,postTitleJPG.length() - 4);
		    row.createCell(1).setCellValue(postTitle);
		    
		    //SIZE CATEGORY
		    String category;
		    
		    if (postTitle.contains("20x5")||postTitle.contains("5x20")){category = "20x5";}
		    if (postTitle.contains("16x24")){category = "16x24";}
		    if (postTitle.contains("24x16")){category = "24x16";}
		    if (postTitle.contains("8x14")||postTitle.contains("14x8")){category = "8x14";}
		    if (postTitle.contains("12x12")){category = "12x12";}
		    if (postTitle.contains("Plasma")||postTitle.contains("5x20")){category = "Plasma";}
		    else{category = "Custom";}
		}
	    

	    //CLOSE AND SAVE
	    wb.write(fileOut);
	    fileOut.close();
	}
	
}
